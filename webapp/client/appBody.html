<template name="appBody">
  <div class="ui container">
    <div style="margin-bottom: 10px;">
      <div class="ui breadcrumb large">
        {{#breadcrumbItem isActive=(isActiveRoute "home")
            href=(pathFor 'home')}}
          Home
        {{/breadcrumbItem}}

        {{#if params.data_set_id}}
          {{#breadcrumbItem isActive=(isActiveRoute "dataSet")
              href=(pathFor "dataSet" data_set_id=params.data_set_id)}}
            {{#if Template.subscriptionsReady}}
              {{getDataSetName}}
            {{/if}}
          {{/breadcrumbItem}}
        {{/if}}

        {{#if params.patient_label}}
          {{#breadcrumbItem isActive=(isActiveRoute "patient")
              href=(pathFor "patient" study_label=params.study_label patient_label=params.patient_label)}}
            {{params.patient_label}}
          {{/breadcrumbItem}}
        {{/if}}

        {{#if params.job_id}}
          {{#breadcrumbItem isActive=(isActiveRoute "upDownGenes")
              href="TODO"}}
            Gene Outlier Analysis
          {{/breadcrumbItem}}
        {{/if}}

        {{#if isActiveRoute "listLimmaGSEA"}}
          {{#breadcrumbItem isActive=true}}
            Limma <i class="right arrow icon"></i> GSEA
          {{/breadcrumbItem}}
        {{/if}}

        {{#if isActiveRoute "createRecord"}}
          {{#breadcrumbItem isActive=true}}
            Create record
          {{/breadcrumbItem}}
        {{/if}}

        {{#if isActiveRoute "createForm"}}
          {{#breadcrumbItem isActive=true}}
            Create form
          {{/breadcrumbItem}}
        {{/if}}

        {{#if isActiveRoute "editRecords"}}
          {{#breadcrumbItem isActive=true}}
            Edit records
          {{/breadcrumbItem}}
        {{/if}}
      </div>

      <div style="float: right;">
        {{> loginButtons}}
      </div>
    </div>

    {{#if loggingIn}}
      {{> loggingInMessage}}
    {{else}}
      {{#if currentUser}}
        {{#if currentMedBookUser}}
          {{>Template.dynamic template=content data=params}}
        {{else}}
          {{> loggingInMessage}}
        {{/if}}
      {{else}}
        <div class="ui massive icon message">
          <i class="warning sign icon"></i>
          <div class="content">
            <div class="header">
              Not logged in!
            </div>
            <p>
              Please log in to continue
            </p>
          </div>
        </div>
      {{/if}}
    {{/if}}
  </div>
</template>

<template name="breadcrumbItem">
  {{#if isActive}}
    <div class="section active">
      {{> UI.contentBlock}}
    </div>
  {{else}}
    <a href={{href}}>
      {{> UI.contentBlock}}
    </a>
    <span class="divider">/</span>
  {{/if}}
</template>

<template name="loggingInMessage">
  <div class="ui massive icon message">
    <i class="notched circle loading icon"></i>
    <div class="content">
      <div class="header">
        Logging in...
      </div>
      <p>
        You'll be on your way in just a moment!
      </p>
    </div>
  </div>
</template>

<template name="dataLoading">
  <div class="ui icon message">
    <i class="notched circle loading icon"></i>
    <div class="content">
      <div class="header">
        One moment please...
      </div>
      <p>We're fetching that data for you.</p>
    </div>
  </div>
</template>

<template name="showErrorMessage">
  {{#with getError}}
    <div class="ui error message">
      <i class="close icon close-error-message"></i>
      <div class="header">{{header}}</div>
      {{{message}}}
    </div>
  {{/with}}
</template>

<template name="routeNotFound">
  <div class="ui message massive">
    <div class="header">Invalid URL</div>
    <p>
      To be completely honest, we don't quite know how you found your way here...
    </p>
    <p>
      Click here to return to the home page:
      <a href={{pathFor "home"}} class="ui primary button">
        <i class="home icon"></i>
        Go home!
      </a>
    </p>
    <p>
      If you think you are seeing this message in error, please {{{contactTeoText}}}
    </p>
  </div>
</template>
